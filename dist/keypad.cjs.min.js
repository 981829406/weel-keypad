"use strict";function __$$styleInject(t,e){void 0===e&&(e={});var r=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===r&&i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}}Object.entries||(Object.entries=function(t){for(var e=Object.keys(t),r=e.length,i=new Array(r);r--;)i[r]=[e[r],t[e[r]]];return i}),Object.keys||(Object.keys=function(t){if(t!==Object(t))throw new TypeError("Object.keys called on a non-object");var e,r=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.push(e);return r}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])}return r},writable:!0,configurable:!0});var upper='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M6 18v-2.016h12v2.016h-12zM12 8.391l-4.594 4.594-1.406-1.406 6-6 6 6-1.406 1.406z"></path></svg>',backspace='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18.984 15.609l-3.563-3.609 3.563-3.609-1.406-1.406-3.563 3.609-3.609-3.609-1.406 1.406 3.609 3.609-3.609 3.609 1.406 1.406 3.609-3.609 3.563 3.609zM21.984 3c1.078 0 2.016 0.938 2.016 2.016v13.969c0 1.078-0.938 2.016-2.016 2.016h-15c-0.703 0-1.219-0.375-1.594-0.891l-5.391-8.109 5.391-8.109c0.375-0.516 0.891-0.891 1.594-0.891h15z"></path></svg>',clear='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" /></svg>',add='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" /></svg>',done='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M9 16.219l10.594-10.641 1.406 1.406-12 12-5.578-5.578 1.359-1.406z"></path></svg>',images=Object.freeze({upper:upper,backspace:backspace,clear:clear,add:add,done:done}),number=[[[7],[8],[9]],[[4],[5],[6]],[[1],[2],[3]],[["svg[backspace]",null,"backspace"],[0],["Â·","."]]],qwer=[[["q"],["w"],["e"],["r"],["t"],["y"],["u"],["i"],["o"],["p"]],[["a"],["s"],["d"],["f"],["g"],["h"],["j"],["k"],["l"]],[["z"],["x"],["c"],["v"],["b"],["n"],["m"]],[["svg[upper]",null,"upper"],["Space"," "],[","],["."],["svg[backspace]",null,"backspace"]]],classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),defineProperty=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},slicedToArray=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!e||r.length!==e);i=!0);}catch(t){n=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),defaultOptions={el:null,input:null,inputWhen:"end",flex:!0,mobile:!0,onstart:null,onend:null,name:"number",show:!1,multiple:!0,render:null,reducer:{wrap:null,container:null,content:null,row:null,key:null},inject:document.body},defaultLayouts={number:number,qwer:qwer},defaultMaps={upper:"upper",ctrl:"ctrl",alt:"alt",shift:"shift"},Keypad=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};classCallCheck(this,t),this.options=Object.assign({},defaultOptions,e),this.layouts=Object.assign({},defaultLayouts,r),this.maps=Object.assign({},defaultMaps,i),this.input=this.options.input,this.wrap=null,this.keypads={},this.hightlight=null,this.locked=null;var n=this.options,a=n.el,s=n.show;a&&this.listen(a),this.inject(),s&&this.show()}return createClass(t,[{key:"prefix",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"elem",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=this.options.flex;return{elem:"kypd"+(void 0===r||r?"-flex":"")+"-"+(e||"span"),attr:"data-kypd-"+(e||"blank")}[t]}},{key:"reducer",value:function(e){var r=this;if(t.istype(this.options.reducer,"object"))return"function"==typeof this.options.reducer[e]?function(t){return r.options.reducer[e].call(r,t)}:function(t){return t};console.error('"reducer" must to be a plain object.')}},{key:"generator",value:function(t){var e=this,r=document.createElement(this.prefix("elem","content")),i=document.createElement(this.prefix("elem","key")),n=document.createElement(this.prefix("elem","key-row")),a=this.reducer("row"),s=this.reducer("key"),o=!0,l=!1,c=void 0;try{for(var u,d=t[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var p=u.value,f=n.cloneNode(),h=function(t,r,n){var a=i.cloneNode();if(/svg\[.+\]/.test(t)){var o=t.match(/svg\[(.+)\]/)[1],l=images[o];if(!l)return console.wran('No image is named "'+o+'"'),"break";var c=document.createElementNS("http://www.w3.org/1999/xhtml","div");c.innerHTML=l,a.appendChild(c.querySelector("svg"))}else if(/(<\/svg>[\s]?)$/.test(t)){var u=document.createElementNS("http://www.w3.org/1999/xhtml","div");u.innerHTML=t,a.appendChild(u.querySelector("svg"))}else a.textContent=t;(r||!r&&!n)&&(r=r||t,a.setAttribute(e.prefix("attr","key-value"),r||t)),n&&a.setAttribute(e.prefix("attr","key-code"),n),a.setAttribute(e.prefix("attr","status"),""),a.addEventListener(e.events.start,function(i){return e.handleKey(i,"start",[t,r,n])},!1),a.addEventListener(e.events.end,function(i){return e.handleKey(i,"end",[t,r,n])},!1),f.appendChild(s(a)),j=r},y=!0,b=!1,k=void 0;try{for(var v,m=p[Symbol.iterator]();!(y=(v=m.next()).done);y=!0){var w=v.value,x=slicedToArray(w,3),g=x[0],j=x[1],A=x[2];if("break"===h(g,j,A))break}}catch(t){b=!0,k=t}finally{try{!y&&m.return&&m.return()}finally{if(b)throw k}}r.appendChild(a(f))}}catch(t){l=!0,c=t}finally{try{!o&&d.return&&d.return()}finally{if(l)throw c}}return r}},{key:"handleKey",value:function(t,e,r){var i=slicedToArray(r,3),n=i[0],a=i[1],s=i[2];t.preventDefault(),t.stopPropagation();var o=t.currentTarget,l=this.prefix("attr","status");if(("active"!==o.getAttribute(l)&&("start"===e&&o.setAttribute(l,"start"),"end"===e&&o.setAttribute(l,"")),s||this.locked!==this.maps.upper||(n=n&&n.toUpperCase(),a=a&&a.toUpperCase()),this.keyMap(e,a,s),"function"==typeof this.options["on"+e])&&this.options["on"+e].call(o,[n,a,s],t))return!0;e===this.options.inputWhen&&this.keyInput(a,s)}},{key:"keyMap",value:function(t,e,r){var i=this.keypads[this.options.name],n=this.prefix("attr","hightlight"),a=i.getAttribute("hightlight")||"";switch(a=a?a+"+"+(r||e):r||e,"start"===t&&(this.hightlight=a,i.setAttribute(n,a)),"end"===t&&i.setAttribute(n,""),r){case this.maps.upper:if("start"===t)break;var s=this.prefix("attr","locked");if(this.locked){this.locked=null,i.removeAttribute(s);break}this.locked=r,i.setAttribute(s,r)}}},{key:"keyInput",value:function(t,e){if(!this.input)return!0;var r=this.input.value,i=this.input.selectionStart;r&&"backspace"===e&&(r=r.slice(0,i-1)+r.slice(i),i--),t&&(r=r.slice(0,i)+t+r.slice(i),i++),this.input.value=r,this.input.selectionEnd=i}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.layouts;if("function"==typeof this.options.render)return this.options.render.call(this);var e=document.createElement(this.prefix("elem","wrap")),r=document.createElement(this.prefix("elem","container"));e.setAttribute(this.prefix("attr","status"),"none");var i=this.reducer("content"),n=this.reducer("container"),a=!0,s=!1,o=void 0;try{for(var l,c=Object.entries(t)[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var u=l.value,d=slicedToArray(u,2),p=d[0],f=d[1],h=this.generator(f),y=r.cloneNode();y.setAttribute(this.prefix("attr","name"),p),y.setAttribute(this.prefix("attr","status"),"ready"),this.keypads[p]=y,y.appendChild(i(h)),e.appendChild(n(y))}}catch(t){s=!0,o=t}finally{try{!a&&c.return&&c.return()}finally{if(s)throw o}}return e.setAttribute(this.prefix("attr","status"),"ready"),this.wrap=this.reducer("wrap")(e),this.wrap}},{key:"inject",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.inject).appendChild(this.render(this.options.multiple?this.layouts:defineProperty({},this.options.name,this.layouts[this.options.name])))}},{key:"listen",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!r)return!1;var i=[];switch(t.istype(r)){case"string":i=document.querySelectorAll(r);break;case"nodelist":i=r;break;default:if(!/html\w*element/.test(t.istype(r)))return!1;i=[r]}if(!i||!i.length)return!1;Array.prototype.forEach.call(i,function(t){t.addEventListener("focus",function(t){e.input=t.currentTarget,e.show()},!1),t.addEventListener("blur",function(t){e.input=null,e.hide()},!1)})}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.name;if(!this.layouts[t])return console.error('Has not a keypad layout named "'+t+'"'),!1;this.wrap.setAttribute(this.prefix("attr","status"),"active"),this.keypads[t].setAttribute(this.prefix("attr","status"),"active")}},{key:"hide",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.name;if(!this.layouts[t])return console.error('Has not a keypad layout named "'+t+'"'),!1;this.wrap.setAttribute(this.prefix("attr","status"),"ready"),this.keypads[t].setAttribute(this.prefix("attr","status"),"ready")}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.name;"active"===this.wrap.getAttribute(this.prefix("attr","status"))?this.hide(t):this.show(t)}},{key:"events",get:function(){var t=this.options.mobile;return{start:t?"touchstart":"mousedown",end:t?"touchend":"mouseup",move:t?"touchmove":"mousemove"}}}],[{key:"istype",value:function(t,e){var r=Object.prototype.toString.call(t).replace(/^\[object (.+)\]$/,"$1").toLowerCase();return e?e===r:r}}]),t}(),css="kypd-flex-wrap,kypd-wrap{width:100%;font-family:Arial,Helvetica,sans-serif;display:block;bottom:0;z-index:1;position:fixed;-webkit-transition:opacity .35s,visibility .35s,-webkit-transform .25s cubic-bezier(.215,.61,.355,1);transition:opacity .35s,visibility .35s,-webkit-transform .25s cubic-bezier(.215,.61,.355,1);transition:opacity .35s,visibility .35s,transform .25s cubic-bezier(.215,.61,.355,1);transition:opacity .35s,visibility .35s,transform .25s cubic-bezier(.215,.61,.355,1),-webkit-transform .25s cubic-bezier(.215,.61,.355,1)}kypd-flex-wrap[data-kypd-status=none],kypd-wrap[data-kypd-status=none]{display:none}kypd-flex-wrap[data-kypd-status=ready],kypd-wrap[data-kypd-status=ready]{opacity:0;visibility:hidden;-webkit-transform:translateY(100%);transform:translateY(100%)}kypd-flex-wrap[data-kypd-status=active],kypd-wrap[data-kypd-status=active]{opacity:1;visibility:visible;-webkit-transform:translateY(0);transform:translateY(0)}kypd-container,kypd-flex-container{width:inherit;left:0;bottom:0;right:0;position:absolute}kypd-container[data-kypd-status=ready],kypd-flex-container[data-kypd-status=ready]{-webkit-transform:translateY(100%);transform:translateY(100%);-webkit-transition:-webkit-transform .25s cubic-bezier(.215,.61,.355,1);transition:-webkit-transform .25s cubic-bezier(.215,.61,.355,1);transition:transform .25s cubic-bezier(.215,.61,.355,1);transition:transform .25s cubic-bezier(.215,.61,.355,1),-webkit-transform .25s cubic-bezier(.215,.61,.355,1)}kypd-container[data-kypd-status=active],kypd-flex-container[data-kypd-status=active]{-webkit-transform:translateY(0);transform:translateY(0)}kypd-container[data-kypd-locked=upper] [data-kypd-key-value],kypd-flex-container[data-kypd-locked=upper] [data-kypd-key-value]{text-transform:uppercase}kypd-flex-key svg,kypd-key svg{fill:currentColor}kypd-flex-container{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}kypd-flex-container[data-kypd-name=number] kypd-flex-content{max-width:240px}kypd-flex-container[data-kypd-name=qwer] kypd-flex-content{max-width:560px}kypd-flex-content{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kypd-flex-content,kypd-flex-key-row{width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}kypd-flex-key-row{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}kypd-flex-key{height:48px;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;display:-webkit-box;display:-ms-flexbox;display:flex}";__$$styleInject(css);var css$2='kypd-flex-wrap,kypd-wrap{background-color:#fff}kypd-flex-container{background-color:inherit;border-top:1px solid #f5f5f5}kypd-flex-container[data-kypd-locked=upper] [data-kypd-key-code=upper]{border-radius:2px;background-color:#07f;color:#fff}kypd-flex-key{cursor:default;border-radius:10px;background-color:#fff;color:#07f;font-size:16px;-webkit-transition:background-color .25s cubic-bezier(.075,.82,.165,1),color .25s cubic-bezier(.175,.885,.32,1.275),border-radius .45s cubic-bezier(.175,.885,.32,1.275);transition:background-color .25s cubic-bezier(.075,.82,.165,1),color .25s cubic-bezier(.175,.885,.32,1.275),border-radius .45s cubic-bezier(.175,.885,.32,1.275)}kypd-flex-key[data-kypd-status=start]{border-radius:2px;background-color:#07f;color:#fff}kypd-flex-key[data-kypd-key-value=" "]{min-width:50%}';__$$styleInject(css$2),module.exports=Keypad;
