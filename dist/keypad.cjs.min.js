"use strict";function __$$styleInject(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style");d.type="text/css","top"===a&&r.firstChild?r.insertBefore(d,r.firstChild):r.appendChild(d),d.styleSheet?d.styleSheet.cssText=e:d.appendChild(document.createTextNode(e))}}Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),a=t.length,r=new Array(a);a--;)r[a]=[t[a],e[t[a]]];return r}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,a=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.push(t);return a}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(e),r=1;r<arguments.length;r++){var d=arguments[r];if(null!=d)for(var n in d)Object.prototype.hasOwnProperty.call(d,n)&&(a[n]=d[n])}return a},writable:!0,configurable:!0}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),r=a.length>>>0;if(0===r)return!1;for(var d=0|t,n=Math.max(d>=0?d:r-Math.abs(d),0);n<r;){if(a[n]===e)return!0;n++}return!1}});var upper='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M6 18v-2.016h12v2.016h-12zM12 8.391l-4.594 4.594-1.406-1.406 6-6 6 6-1.406 1.406z"></path></svg>',backspace='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18.984 15.609l-3.563-3.609 3.563-3.609-1.406-1.406-3.563 3.609-3.609-3.609-1.406 1.406 3.609 3.609-3.609 3.609 1.406 1.406 3.609-3.609 3.563 3.609zM21.984 3c1.078 0 2.016 0.938 2.016 2.016v13.969c0 1.078-0.938 2.016-2.016 2.016h-15c-0.703 0-1.219-0.375-1.594-0.891l-5.391-8.109 5.391-8.109c0.375-0.516 0.891-0.891 1.594-0.891h15z"></path></svg>',clear='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" /></svg>',add='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" /></svg>',done='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M9 16.219l10.594-10.641 1.406 1.406-12 12-5.578-5.578 1.359-1.406z"></path></svg>',images=Object.freeze({upper:upper,backspace:backspace,clear:clear,add:add,done:done}),number=[[[7],[8],[9]],[[4],[5],[6]],[[1],[2],[3]],[["En",null,"@@qwer"],["Â·","."],[0],["svg[backspace]",null,"backspace"]]],qwer=[[["q"],["w"],["e"],["r"],["t"],["y"],["u"],["i"],["o"],["p"]],[["a"],["s"],["d"],["f"],["g"],["h"],["j"],["k"],["l"]],[["svg[upper]",null,"upper"],["z"],["x"],["c"],["v"],["b"],["n"],["m"],[","],["."]],[["123",null,"@@number"],["Space"," "],["svg[backspace]",null,"backspace"],["svg[done]",null,"enter"]]],classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),defineProperty=function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e},slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],r=!0,d=!1,n=void 0;try{for(var i,p=e[Symbol.iterator]();!(r=(i=p.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){d=!0,n=e}finally{try{!r&&p.return&&p.return()}finally{if(d)throw n}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),defaultOptions={el:null,input:null,inputWhen:"end",flex:!0,mobile:!0,onstart:null,onend:null,name:"number",show:!1,multiple:!0,render:null,reducer:{wrap:null,container:null,content:null,row:null,key:null},theme:"default",dark:!1,inject:document.body},defaultLayouts={number:number,qwer:qwer},defaultMaps={upper:"upper",ctrl:"ctrl",alt:"alt",shift:"shift"},Keypad=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};classCallCheck(this,e),this.options=Object.assign({},defaultOptions,t),this.layouts=Object.assign({},defaultLayouts,a),this.maps=Object.assign({},defaultMaps,r),this.input=this.options.input,this.wrap=null,this.keypads={},this.hightlight=null,this.locked=null;var d=this.options,n=d.el,i=d.show;n&&this.listen(n),this.inject(),i&&this.show()}return createClass(e,[{key:"prefix",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"elem",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=this.options.flex;return{elem:"kypd"+(void 0===a||a?"-flex":"")+"-"+(t||"span"),attr:"data-kypd-"+(t||"blank")}[e]}},{key:"reducer",value:function(t){var a=this;if(e.istype(this.options.reducer,"object"))return"function"==typeof this.options.reducer[t]?function(e){return a.options.reducer[t].call(a,e)}:function(e){return e};console.error('"reducer" must to be a plain object.')}},{key:"generator",value:function(e){var t=this,a=document.createElement(this.prefix("elem","content")),r=document.createElement(this.prefix("elem","key")),d=document.createElement(this.prefix("elem","key-row")),n=this.reducer("row"),i=this.reducer("key"),p=!0,o=!1,s=void 0;try{for(var l,y=e[Symbol.iterator]();!(p=(l=y.next()).done);p=!0){var k=l.value,u=d.cloneNode(),c=function(e,a,d){var n=r.cloneNode();if(/svg\[.+\]/.test(e)){var p=e.match(/svg\[(.+)\]/)[1],o=images[p];if(!o)return console.wran('No image is named "'+p+'"'),"break";var s=document.createElementNS("http://www.w3.org/1999/xhtml","div");s.innerHTML=o,n.appendChild(s.querySelector("svg"))}else if(/(<\/svg>[\s]?)$/.test(e)){var l=document.createElementNS("http://www.w3.org/1999/xhtml","div");l.innerHTML=e,n.appendChild(l.querySelector("svg"))}else n.textContent=e;(a||!a&&!d)&&(a=a||e,n.setAttribute(t.prefix("attr","key-value"),a||e)),d&&n.setAttribute(t.prefix("attr","key-code"),d),n.setAttribute(t.prefix("attr","status"),""),n.addEventListener(t.events.start,function(r){return t.handleKey(r,"start",[e,a,d])},!1),n.addEventListener(t.events.end,function(r){return t.handleKey(r,"end",[e,a,d])},!1),u.appendChild(i(n)),j=a},f=!0,h=!1,b=void 0;try{for(var m,x=k[Symbol.iterator]();!(f=(m=x.next()).done);f=!0){var w=m.value,v=slicedToArray(w,3),g=v[0],j=v[1],A=v[2];if("break"===c(g,j,A))break}}catch(e){h=!0,b=e}finally{try{!f&&x.return&&x.return()}finally{if(h)throw b}}a.appendChild(n(u))}}catch(e){o=!0,s=e}finally{try{!p&&y.return&&y.return()}finally{if(o)throw s}}return a}},{key:"handleKey",value:function(e,t,a){var r=slicedToArray(a,3),d=r[0],n=r[1],i=r[2];e.preventDefault(),e.stopPropagation();var p=e.currentTarget,o=this.prefix("attr","status");if(("active"!==p.getAttribute(o)&&("start"===t&&p.setAttribute(o,"start"),"end"===t&&p.setAttribute(o,"")),i||this.locked!==this.maps.upper||(d=d&&d.toUpperCase(),n=n&&n.toUpperCase()),this.keyMap(t,n,i),"function"==typeof this.options["on"+t])&&this.options["on"+t].call(p,[d,n,i],e))return!0;t===this.options.inputWhen&&this.keyInput(n,i)}},{key:"keyMap",value:function(e,t,a){var r=this.keypads[this.options.name],d=this.prefix("attr","hightlight"),n=r.getAttribute("hightlight")||"";if(n=n?n+"+"+(a||t):a||t,"start"===e&&(this.hightlight=n,r.setAttribute(d,n)),"end"===e&&r.setAttribute(d,""),"start"===e&&a===this.maps.upper){var i=this.prefix("attr","locked");this.locked?(this.locked=null,r.removeAttribute(i)):(this.locked=a,r.setAttribute(i,a))}if("end"===e&&/^@@/.test(a)){var p=a.match(/^@@(.*)/)[1];this.hide();var o=Object.keys(this.layouts);if("string"==typeof p&&!p.length){var s=o.indexOf(this.options.name)+1;this.options.name=o[s===o.length?0:s]}o.includes(p)&&(this.options.name=p),this.show()}}},{key:"keyInput",value:function(t,a){if(!this.input)return!0;var r=this.input.value,d=this.input.selectionStart;r&&"backspace"===a&&(r=r.slice(0,d-1)+r.slice(d),d--);var n=e.istype(t);"null"!==n&&"undefined"!==n&&(r=r.slice(0,d)+t+r.slice(d),d++),this.input.value=r,this.input.selectionEnd=d}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.layouts;if("function"==typeof this.options.render)return this.options.render.call(this);var t=document.createElement(this.prefix("elem","wrap")),a=document.createElement(this.prefix("elem","container"));t.setAttribute(this.prefix("attr","status"),"none");var r=this.reducer("content"),d=this.reducer("container"),n=!0,i=!1,p=void 0;try{for(var o,s=Object.entries(e)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value,y=slicedToArray(l,2),k=y[0],u=y[1],c=this.generator(u),f=a.cloneNode();f.setAttribute(this.prefix("attr","name"),k),f.setAttribute(this.prefix("attr","status"),"ready"),this.keypads[k]=f,f.appendChild(r(c)),t.appendChild(d(f))}}catch(e){i=!0,p=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw p}}return t.setAttribute(this.prefix("attr","status"),"ready"),t.setAttribute(this.prefix("attr","theme"),this.options.theme),t.setAttribute(this.prefix("attr","dark"),this.options.dark),this.wrap=this.reducer("wrap")(t),this.wrap}},{key:"inject",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.inject).appendChild(this.render(this.options.multiple?this.layouts:defineProperty({},this.options.name,this.layouts[this.options.name])))}},{key:"listen",value:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!a)return!1;var r=[];switch(e.istype(a)){case"string":r=document.querySelectorAll(a);break;case"nodelist":r=a;break;default:if(!/html\w*element/.test(e.istype(a)))return!1;r=[a]}if(!r||!r.length)return!1;Array.prototype.forEach.call(r,function(e){e.addEventListener("focus",function(e){t.input=e.currentTarget,t.show()},!1),e.addEventListener("blur",function(e){t.input=null,t.hide()},!1)})}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.name;if(!this.layouts[e])return console.error('Has not a keypad layout named "'+e+'"'),!1;this.wrap.setAttribute(this.prefix("attr","status"),"active"),this.keypads[e].setAttribute(this.prefix("attr","status"),"active")}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.name;if(!this.layouts[e])return console.error('Has not a keypad layout named "'+e+'"'),!1;this.wrap.setAttribute(this.prefix("attr","status"),"ready"),this.keypads[e].setAttribute(this.prefix("attr","status"),"ready")}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.name;"active"===this.wrap.getAttribute(this.prefix("attr","status"))?this.hide(e):this.show(e)}},{key:"events",get:function(){var e=this.options.mobile;return{start:e?"touchstart":"mousedown",end:e?"touchend":"mouseup",move:e?"touchmove":"mousemove"}}}],[{key:"istype",value:function(e,t){var a=Object.prototype.toString.call(e).replace(/^\[object (.+)\]$/,"$1").toLowerCase();return t?t===a:a}}]),e}(),css="kypd-flex-wrap,kypd-wrap{width:100%;font-family:Arial,Helvetica,sans-serif;display:block;bottom:0;z-index:1;position:fixed;-webkit-transition:opacity .35s,visibility .35s,-webkit-transform .25s cubic-bezier(.215,.61,.355,1);transition:opacity .35s,visibility .35s,-webkit-transform .25s cubic-bezier(.215,.61,.355,1);transition:opacity .35s,visibility .35s,transform .25s cubic-bezier(.215,.61,.355,1);transition:opacity .35s,visibility .35s,transform .25s cubic-bezier(.215,.61,.355,1),-webkit-transform .25s cubic-bezier(.215,.61,.355,1)}kypd-flex-wrap[data-kypd-status=none],kypd-wrap[data-kypd-status=none]{display:none}kypd-flex-wrap[data-kypd-status=ready],kypd-wrap[data-kypd-status=ready]{opacity:0;visibility:hidden;-webkit-transform:translateY(100%);transform:translateY(100%)}kypd-flex-wrap[data-kypd-status=active],kypd-wrap[data-kypd-status=active]{opacity:1;visibility:visible;-webkit-transform:translateY(0);transform:translateY(0)}kypd-container,kypd-flex-container{width:inherit;left:0;bottom:0;right:0;position:absolute}kypd-container[data-kypd-status=ready],kypd-flex-container[data-kypd-status=ready]{-webkit-transform:translateY(100%);transform:translateY(100%);-webkit-transition:-webkit-transform .25s cubic-bezier(.215,.61,.355,1);transition:-webkit-transform .25s cubic-bezier(.215,.61,.355,1);transition:transform .25s cubic-bezier(.215,.61,.355,1);transition:transform .25s cubic-bezier(.215,.61,.355,1),-webkit-transform .25s cubic-bezier(.215,.61,.355,1)}kypd-container[data-kypd-status=active],kypd-flex-container[data-kypd-status=active]{-webkit-transform:translateY(0);transform:translateY(0)}kypd-container[data-kypd-locked=upper] [data-kypd-key-value],kypd-flex-container[data-kypd-locked=upper] [data-kypd-key-value]{text-transform:uppercase}kypd-flex-key svg,kypd-key svg{fill:currentColor}kypd-flex-container{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}kypd-flex-container[data-kypd-name=number] kypd-flex-content{max-width:240px}kypd-flex-container[data-kypd-name=qwer] kypd-flex-content{max-width:560px}kypd-flex-content{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kypd-flex-content,kypd-flex-key-row{width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}kypd-flex-key-row{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}kypd-flex-key{height:48px;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:auto;flex:auto}";__$$styleInject(css);var css$2='kypd-flex-wrap[data-kypd-theme=default],kypd-wrap[data-kypd-theme=default]{background-color:#fff}kypd-flex-wrap[data-kypd-theme=default] kypd-container,kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container,kypd-wrap[data-kypd-theme=default] kypd-container,kypd-wrap[data-kypd-theme=default] kypd-flex-container{background-color:inherit;border-top:1px solid #f5f5f5;padding:8px 0}kypd-flex-wrap[data-kypd-theme=default] kypd-container[data-kypd-locked=upper] [data-kypd-key-code=upper],kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-locked=upper] [data-kypd-key-code=upper],kypd-wrap[data-kypd-theme=default] kypd-container[data-kypd-locked=upper] [data-kypd-key-code=upper],kypd-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-locked=upper] [data-kypd-key-code=upper]{border-radius:2px;background-color:#07f;color:#fff}kypd-flex-wrap[data-kypd-theme=default] kypd-flex-key,kypd-flex-wrap[data-kypd-theme=default] kypd-key,kypd-wrap[data-kypd-theme=default] kypd-flex-key,kypd-wrap[data-kypd-theme=default] kypd-key{cursor:default;border-radius:2px;-webkit-box-shadow:0 1px 2px rgba(73,158,255,.431);box-shadow:0 1px 2px rgba(73,158,255,.431);margin:2px;font-size:16px;background-color:#fff;color:#07f;-webkit-transition:background-color .25s cubic-bezier(.075,.82,.165,1),color .25s cubic-bezier(.175,.885,.32,1.275);transition:background-color .25s cubic-bezier(.075,.82,.165,1),color .25s cubic-bezier(.175,.885,.32,1.275)}kypd-flex-wrap[data-kypd-theme=default] kypd-flex-key[data-kypd-status=start],kypd-flex-wrap[data-kypd-theme=default] kypd-key[data-kypd-status=start],kypd-wrap[data-kypd-theme=default] kypd-flex-key[data-kypd-status=start],kypd-wrap[data-kypd-theme=default] kypd-key[data-kypd-status=start]{background-color:#07f;color:#fff}kypd-flex-wrap[data-kypd-theme=default] kypd-flex-key[data-kypd-key-code=enter],kypd-flex-wrap[data-kypd-theme=default] kypd-key[data-kypd-key-code=enter],kypd-wrap[data-kypd-theme=default] kypd-flex-key[data-kypd-key-code=enter],kypd-wrap[data-kypd-theme=default] kypd-key[data-kypd-key-code=enter]{border-radius:8px;background-color:#07f;color:#fff}kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-name=number] kypd-flex-key{width:0}kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-name=number] kypd-flex-key[data-kypd-key-code=backspace],kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-name=number] kypd-flex-key[data-kypd-key-value="0"]{-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2}kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-name=qwer] kypd-flex-key{width:0}kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-name=qwer] kypd-flex-key[data-kypd-key-value=" "]{-webkit-box-flex:6;-ms-flex-positive:6;flex-grow:6}kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-name=qwer] kypd-flex-key[data-kypd-key-code="@@number"],kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-name=qwer] kypd-flex-key[data-kypd-key-code=backspace],kypd-flex-wrap[data-kypd-theme=default] kypd-flex-container[data-kypd-name=qwer] kypd-flex-key[data-kypd-key-code=enter]{-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2}';__$$styleInject(css$2);var css$4="kypd-flex-wrap[data-kypd-theme=default][data-kypd-dark=true],kypd-wrap[data-kypd-theme=default][data-kypd-dark=true]{background-color:#1b1d20}kypd-flex-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-flex-key,kypd-flex-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-key,kypd-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-flex-key,kypd-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-key{background-color:#1b1d20;-webkit-box-shadow:0 1px 2px rgba(63,84,107,.431);box-shadow:0 1px 2px rgba(63,84,107,.431)}kypd-flex-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-flex-key[data-kypd-key-code=enter],kypd-flex-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-flex-key[data-kypd-status=start],kypd-flex-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-key[data-kypd-key-code=enter],kypd-flex-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-key[data-kypd-status=start],kypd-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-flex-key[data-kypd-key-code=enter],kypd-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-flex-key[data-kypd-status=start],kypd-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-key[data-kypd-key-code=enter],kypd-wrap[data-kypd-theme=default][data-kypd-dark=true] kypd-key[data-kypd-status=start]{background-color:#07f;color:#1b1d20}";__$$styleInject(css$4),module.exports=Keypad;
